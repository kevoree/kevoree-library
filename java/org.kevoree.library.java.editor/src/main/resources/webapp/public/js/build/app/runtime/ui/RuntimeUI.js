define(["util/Logger","jquery","jqueryui/effect-highlight","bootstrap/tab"],function(e,t){function n(e){this._ctrl=e,this._header=t("#header"),this._tabsContainer=t("#tabs-container"),this._tabs=t("#tabs"),this._tabsPane=t("#tabs-container .tab-pane"),this._tabCounter=this._tabsPane.size(),this._startNodeBtn=t("#node-start"),this._stopNodeBtn=t("#node-stop"),this._nodeName=t("#node-name"),this._grpSelect=t("#node-grp"),this._serverUrl=t("#server-ip"),this._actionClearLog=t("#action-clear-log"),this._tabsMap=[],r(this),i(this)}function r(e){function n(){var n=t("body").outerHeight(!0),r=e._header.outerHeight(!0),i=e._tabsContainer.css("padding-top"),s=e._tabs.outerHeight(!0),o=parseInt(i.substr(0,i.length-2));i=o==0?50:o,e._tabsPane.each(function(){t(this).height(n-r-s-i+"px")})}e._tabsPane=t("#tabs-container .tab-pane"),e._tabs=t("#tabs"),e._tabCounter=e._tabsPane.size(),t(document).ready(n),t(window).resize(n)}function i(t){t._nodeName.on("keyup",function(e){e.keyCode==13&&s(t)}),t._startNodeBtn.on("click",function(){s(t)}),t._stopNodeBtn.on("click",function(){t._ctrl.p2cStopNode()}),t._actionClearLog.on("click",function(t){e.clear(),t.preventDefault()}),t._serverUrl.on("click",function(e){return e.preventDefault(),!1})}function s(e){e._ctrl.p2cStartNode({nodeName:e._nodeName.val(),groupName:e._grpSelect.find("option:selected").val(),serverUrl:e._serverUrl.val()})}return n.prototype.addTab=function(e,n){this._tabCounter+=1;var i="appended-tab-"+this._tabCounter,s="tab-content-"+this._tabCounter;t("#tabs").append('<li id="'+i+'">'+'<a href="#'+s+'" data-toggle="tab">'+e+"</a>"+"</li>"),t("#tabs-content").append('<div id="'+s+'" class="tab-pane in">'+"<p>Your browser does not support Shadow DOM. You should consider using a real one (like Google Chrome or Firefox)</p>"+"</div>");var o=document.getElementById(s).createShadowRoot();o.innerHTML=n,t("#"+i).effect("highlight",{color:"#fff"},500),r(this),this._tabsMap.push({tab_id:i,content_id:s,name:e})},n.prototype.removeTab=function(e){for(var n=0;n<this._tabsMap.length;n++)if(this._tabsMap[n].name==e){t("#"+this._tabsMap[n].tab_id).empty(),t("#"+this._tabsMap[n].content_id).empty(),this._tabsMap.splice(n,1);return}},n.prototype.c2pNodeStarted=function(t){this._nodeName.val(t.nodeName),this._startNodeBtn.addClass("disabled"),this._stopNodeBtn.removeClass("disabled"),e.log("Starting "+t.nodeName+" with "+this._grpSelect.find('option[value="'+t.groupName+'"]').text())},n.prototype.c2pNodeStartFailed=function(){this._startNodeBtn.effect("highlight",{color:"#f00"})},n.prototype.c2pSetNodeName=function(e){this._nodeName.val(e)},n.prototype.c2pSetServerIP=function(e){this._serverUrl.val(e)},n.prototype.c2pNodeStopped=function(){this._startNodeBtn.removeClass("disabled"),this._stopNodeBtn.addClass("disabled"),e.log("Node stopped")},n.prototype.inflateGroupSelector=function(e){for(var t=0;t<e.length;t++)this._grpSelect.append('<option value="'+e[t]+'">'+e[t]+"</option>")},n});