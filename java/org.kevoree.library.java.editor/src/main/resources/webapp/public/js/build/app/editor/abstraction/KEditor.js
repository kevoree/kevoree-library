define(["util/ModelHelper","visitor/UpdateModelVisitor","visitor/RemoveModelVisitor","visitor/InstanceModelVisitor","kevoree"],function(e,t,n,r,i){function s(){this._entities=[],this._typeCounter=[],this._model=null,this._updateVisitor=new t,this._removeVisitor=new n,this._instanceVisitor=new r,this._factory=new i.org.kevoree.impl.DefaultKevoreeFactory,this._lockedModel=!1,this._libraries={}}return s.prototype.addEntity=function(e){this._entities.push(e),console.log("Editor.addEntity ",e),this._typeCounter[e.getType()]||(this._typeCounter[e.getType()]=0),this._typeCounter[e.getType()]++,this._lockedModel||e.accept(this._updateVisitor)},s.prototype.removeEntity=function(e){var t=this._entities.indexOf(e);t!=-1&&(this._entities.splice(t,1),console.log("Editor.removedEntity (index: "+t+")",e),this._typeCounter[e.getType()]--,this._lockedModel||e.accept(this._removeVisitor))},s.prototype.getEntity=function(e){for(var t=0;t<this._entities.length;t++){if(this._entities[t].getName()==e)return this._entities[t];if(this._entities[t].getEntity&&typeof this._entities[t].getEntity=="function"){var n=this._entities[t].getEntity(e);if(n!=null)return n}}return null},s.prototype.addWire=function(e){e.accept(this._updateVisitor),console.log("Editor.addWire ",e)},s.prototype.removeWire=function(e){e.accept(this._removeVisitor),console.log("Editor.removedWire ",e)},s.prototype.addNestableEntity=function(e){this._typeCounter[e.getType()]||(this._typeCounter[e.getType()]=0),this._typeCounter[e.getType()]++,this._lockedModel||e.accept(this._updateVisitor),console.log("Editor.addNestableEntity ",e)},s.prototype.removeNestableEntity=function(e){this._typeCounter[e.getType()]--,this._lockedModel||e.accept(this._removeVisitor),console.log("Editor.removeNestableEntity ",e)},s.prototype.clear=function(){this.clearInstances(),this._model=null},s.prototype.clearInstances=function(){var e=this._entities.slice(0);for(var t=0;t<e.length;t++)e[t].remove();this._entities.length=0,this._typeCounter.length=0},s.prototype.hasEntity=function(e){for(var t=0;t<this._entities.length;t++){if(this._entities[t].getName()==e.getName())return!0;if(this._entities[t].hasChild&&typeof this._entities[t].hasChild=="function"&&this._entities[t].hasChild(e))return!0}return!1},s.prototype.setModel=function(e){this.clear(),this._model=e,this._updateVisitor.setModel(e),this._removeVisitor.setModel(e),this._lockedModel=!0,this._instanceVisitor.visitEditor(this),this._lockedModel=!1,this._model.addModelTreeListener({elementChanged:function(e){}})},s.prototype.mergeModel=function(e){if(this._model!=null){var t=new i.org.kevoree.compare.DefaultModelCompare,n=t.merge(e,this._model);n.applyOn(e)}this.setModel(e)},s.prototype.updateModel=function(e){this._lockedModel||e.accept(this._updateVisitor)},s.prototype.addToModel=function(e){this._lockedModel||e.accept(this._updateVisitor)},s.prototype.removeFromModel=function(e){this._lockedModel||e.accept(this._removeVisitor)},s.prototype.getModel=function(){return this._model},s.prototype.getEntityCount=function(e){return this._typeCounter[e]||0},s.prototype.addLibraries=function(e,t){this._libraries[e]=t},s.prototype.getLibraries=function(e){return this._libraries[e]},s});