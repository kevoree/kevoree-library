define(["util/AlertPopupHelper","templates/select-channel-list"],function(e,t){function r(e){this._ctrl=e,this._circle=new Kinetic.Circle({radius:n,fillLinearGradientStartPoint:[0,0],fillLinearGradientEndPoint:[0,n*2],fillLinearGradientColorStops:[0,"#bc7645",1,"#8e7361"],strokeWidth:2}),this._text=new Kinetic.Text({text:e.getName().substr(0,5),fontSize:9,fontStyle:"bold",fontFamily:"Helvetica",fill:"#FFF",align:"center"}),this._text.move(-this._text.getWidth()/2,-this._text.getHeight()/2+(n+5)),this._shape=new Kinetic.Group({x:100,y:100}),this._shape.add(this._circle),this._shape.add(this._text),this._shape.on("mousedown touchstart",function(){e.p2cMouseDown()}),this._shape.on("mouseup touchend",function(){e.p2cMouseUp()})}var n=12;return r.prototype.getPosition=function(){var e=this._shape.getAbsolutePosition(),t=this._shape.getStage().getScale(),n=this._shape.getStage().getPosition();return{x:(e.x-n.x)/t.x,y:(e.y-n.y)/t.y}},r.prototype.getShape=function(){return this._shape},r.prototype.c2pWireCreationStarted=function(e){var t=this._ctrl.getComponent().getEditor().getUI().getWiresLayer();e.setTargetPoint(this.getPosition()),t.draw(),this._ctrl.getComponent().getUI().setDraggable(!1,!0,!0)},r.prototype.c2pWireCreationPossible=function(e,n){$("#select-channel-popup").modal("show");var r=this;$("#select-channel-list").html(t({channels:n})),$("#selected-channel").off("click"),$("#selected-channel").on("click",function(){var t=$(".channel-type-item:checked"),i=t.attr("data-channel-id");r._ctrl.p2cChannelSelectedForWireCreation(e,n[i]),$("#select-channel-popup").modal("hide")})},r.prototype.c2pWireCreationImpossibleNoChannel=function(){e.setHTML("<p>There is no channel in the current model.<br/>Binding port is not possible.<br/></p>"),e.setType(e.WARN),e.show(5e3)},r.prototype.setDraggable=function(e,t,n){this._ctrl.getComponent().getUI().setDraggable(e,t,n)},r.prototype.getRadius=function(){return n},r.prototype.getHeight=function(){return n*2+this._text.getHeight()},r});