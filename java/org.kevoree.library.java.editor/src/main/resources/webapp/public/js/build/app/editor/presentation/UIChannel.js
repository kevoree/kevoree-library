define(["util/Pooffs","presentation/UIEntity","presentation/property/UIChannelProps"],function(e,t,n){function a(e){t.prototype.constructor.call(this,e),this._circle=new Kinetic.Circle({radius:i,fill:"#de7c37",stroke:s,strokeWidth:r,shadowColor:"black",shadowBlur:10,shadowOffset:[5,5],shadowOpacity:.2,opacity:.6});var o=new Kinetic.Text({text:e.getName()+"\n"+e.getType(),fontSize:12,fontFamily:"Helvetica",fontWeight:"bold",fill:"#FFF",align:"center",width:this._circle.getWidth()-10,drawFunc:function(t){this.drawFunc(t),o.setText(e.getName()+"\n"+e.getType())}});o.move(-o.getWidth()/2,-o.getHeight()/2),this._shape=new Kinetic.Group({draggable:!0}),this._shape.add(this._circle),this._shape.add(o);var u=this;this._shape.on("mouseover touchmove",function(){u._ctrl.p2cMouseOver()}),this._shape.on("mouseout touchend",function(){document.body.style.cursor="default",u._circle.setStrokeWidth(r),u._circle.setStroke(s),u._circle.getLayer().draw()}),this._shape.on("mouseup touchend",function(){u._ctrl.p2cMouseUp()}),this._shape.on("dragmove touchmove",function(){u._ctrl.p2cDragMove()});var a=new n(e);this._shape.on("dblclick dbltap",function(e){e.cancelBubble=!0,a.show()}),this._shape.on("dragend",function(){u._ctrl.p2cDragEnd()})}var r=3,i=45,s="white",o="red",u="green";return e.extends(a,t),a.prototype.getPosition=function(e){var t=this._circle.getAbsolutePosition(),n=this._circle.getStage().getScale(),r=this._circle.getStage().getPosition(),t={x:(t.x-r.x)/n.x,y:(t.y-r.y)/n.y};return e&&e.y>t.y?{x:t.x,y:t.y+i-10}:{x:t.x,y:t.y-i+10}},a.prototype.c2pDropPossible=function(){document.body.style.cursor="pointer",this._circle.setStrokeWidth(r+1),this._circle.setStroke(u),this._circle.getLayer().draw()},a.prototype.c2pDropImpossible=function(){document.body.style.cursor="pointer",this._circle.setStrokeWidth(r+1),this._circle.setStroke(o),this._circle.getLayer().draw()},a.prototype.c2pPointerOverShape=function(){document.body.style.cursor="pointer",this._circle.setStrokeWidth(r+1),this._circle.getLayer().draw()},a.prototype.c2pWireCreated=function(e){e.getCtrl().getOrigin().getComponent().getUI().setDraggable(!0,!0,!0)},a});