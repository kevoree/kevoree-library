define(["ui/RuntimeUI","app_util/QueryString","core/KevoreeJSBootstrap","util/Logger"],function(e,t,n,r){function s(){this._isStarted=!1,this._tabs=[],this._bootstrapper=new n,this._ui=new e(this);var r=u();this._ui.inflateGroupSelector(r),this._queryString=new t;var i=this;this._queryString.process({name:function(e){i.setNodeName(e)},server:function(e){i.setServerIP(e)}})}function o(e){var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}function u(){return["WebRTCGroup"]}var i="kevoree.org:9042/default";return s.prototype.p2cStartNode=function(e){e.nodeName=e.nodeName&&e.nodeName.length>0?e.nodeName:"node"+o(4),e.serverUrl=e.serverUrl&&e.serverUrl.length>0?e.serverUrl:i;if(!this._isStarted){var t=this;this._bootstrapper.start(e.nodeName,e.groupName,e.serverUrl,function(n){t._started=n,n?t._ui.c2pNodeStarted(e):t._ui.c2pNodeStartFailed()})}},s.prototype.p2cStopNode=function(){this._isStarted&&(this._isStarted=!1,this._ui.c2pNodeStopped())},s.prototype.addTab=function(e,t){for(var n=0;n<this._tabs.length;n++)if(this._tabs[n].name==e){e="Tab"+o(3);break}this._tabs.push({name:e,content:t}),this._ui.addTab(e,t)},s.prototype.removeTab=function(e){if(e){for(var t=0;t<this._tabs.length;t++)if(this._tabs[t].name==e){this._ui.removeTab(e),this._tabs.slice(t,1);return}}else{var n=this._tabs.pop();n&&this._ui.removeTab(n.name)}},s.prototype.setNodeName=function(e){this._ui.c2pSetNodeName(e)},s.prototype.setServerIP=function(e){this._ui.c2pSetServerIP(e)},s});