define(["templates/dictionary","templates/fragment-dictionary"],function(e,t){function r(e){this._ctrl=e}var n=".entity-dictionary";return r.prototype.getHTML=function(){return this._ctrl.isFragment()?t({fragments:[]}):e({name:this._ctrl.getEntity().getName(),attrsHTML:function(e){var t="";for(var n=0;n<e;n++)t+=e[n].getUI().getHTML();return t}(this._ctrl.getValues())});var n,r,i,s},r.prototype.onHTMLAppended=function(){var e=this;$("#prop-popup-save").off("click"+n),$("#prop-popup-save").on("click"+n,function(){var t=[],n=[],r=e._ctrl.getValues();for(var i=0;i<r.length;i++){var s=r[i].getName(),o=e._ctrl.isFragment();if(o){var u=e._ctrl.getName();n[u]==undefined&&(n[u]=[],n.length+=1),n[u][s]=$("#instance-attr-"+u+"-"+s).val(),n[u].length+=1}else t[s]=$("#instance-attr-"+s).val(),t.length+=1}e._ctrl.p2cSaveDictionary(t,n)});for(var t=0;t<this._ctrl.getValues().length;t++)this._ctrl.getValues()[t].getUI().onHTMLAppended()},r});